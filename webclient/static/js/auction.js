// Generated by CoffeeScript 1.3.3
(function() {
  var auction;

  $(document).ready(function() {
    return auction.init();
  });

  auction = {
    init: function() {
      var oAuction;
      oAuction = null;
      callApi(AUCTION_DETAIL, {
        id: auction_id
      }, function(data) {
        var b, i, m, n, p, u, w;
        if (!data.result) {
          return document.location.href = '/';
        } else {
          oAuction = data.result[0];
          i = oAuction.id;
          n = oAuction.name;
          b = oAuction.base_price;
          u = oAuction.product_url;
          m = oAuction.image_url;
          p = oAuction.price;
          w = oAuction.winner;
          oAuction.time_left = secondsToHms(oAuction.time_left);
          $('#auction-name').html(oAuction.name);
          $('#auction-image').html('<img src="' + oAuction.image_url + '" alt="' + oAuction.name + '" width="292" height="242" />');
          $('#current-price').html('P' + oAuction.price);
          $('#current-winner').html(oAuction.winner);
          $('#auction-baseprice').html(oAuction.base_price);
          return $('#auction-time-left').html(oAuction.time_left);
        }
      });
      return $("#createautobidder-form").submit(function(e) {
        var email, error, first_name, last_name, password, termsaccepted, username;
        e.preventDefault();
        error = "<ul style='clear: both'>";
        first_name = $("#FirstName").val();
        last_name = $("#LastName").val();
        username = $("#Username").val();
        email = $("#Email").val();
        password = $("#Password").val();
        termsaccepted = $("#termsandconditions:checked").val();
        if (first_name.length === 0) {
          error += "<li>A First Name is required.<li/>";
        }
        if (last_name.length === 0) {
          error += "<li>A Last Name is required.<li/>";
        }
        if (username.length === 0) {
          error += "<li>A username is required.<li/>";
        }
        if (email.length === 0) {
          error += "<li>An email address is required.<li/>";
        }
        if (password.length === 0) {
          error += "<li>A password is required.<li/>";
        }
        if (!termsaccepted) {
          error += "<li>You must accept our terms and conditions to register an account.<li/>";
        }
        error += "</ul>";
        if (error !== "<ul style='clear: both'></ul>") {
          showDialog("error", "Registration Error", error);
          return false;
        }
        callApi(USER_REGISTER, {
          first_name: first_name,
          last_name: last_name,
          username: username,
          email: email,
          password: password
        }, function(data) {
          if (data.exception) {
            showDialog("error", "Registration Error", data.exception);
            return;
          }
          if (data.result) {
            $("div#registration-form").slideUp('slow', function() {
              $("div#registration-complete strong").text(email);
              return $("div#registration-complete").fadeIn(1000);
            });
          }
        });
        return false;
      });
    }
  };

}).call(this);
