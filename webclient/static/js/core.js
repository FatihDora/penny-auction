// Generated by CoffeeScript 1.3.3
var AJAX_KEYPRESS_DELAY, API, BID, CANCEL_AUTO_BIDDER, CREATE_AUTO_BIDDER, GET_AUCTION_INFO, GET_AUTO_BIDDER_STATUS, GET_NONCE, LIST_AUTO_BIDDERS_FOR_AUCTION, LIST_AUTO_BIDDERS_FOR_USER, USER_AUTHENTICATE, USER_EMAIL_EXISTS, USER_REGISTER, USER_USERNAME_EXISTS;

API = "http://localhost:8081";

CREATE_AUTO_BIDDER = "/create_auto_bidder";

GET_AUTO_BIDDER_STATUS = "/get_auto_bidder_status";

CANCEL_AUTO_BIDDER = "/cancel_auto_bidder";

LIST_AUTO_BIDDERS_FOR_USER = "/list_auto_bidders_for_user";

LIST_AUTO_BIDDERS_FOR_AUCTION = "/list_auto_bidders_for_auction";

USER_REGISTER = "/user_register";

USER_AUTHENTICATE = "/user_authenticate";

GET_NONCE = "/get_nonce";

USER_USERNAME_EXISTS = "/user_username_exists";

USER_EMAIL_EXISTS = "/user_email_exists";

BID = "/bid";

GET_AUCTION_INFO = "/get_auction_info";

AJAX_KEYPRESS_DELAY = 500;

$(document).ready(function() {
  /*
  	Order of Operations
  	 
  	1) Initialize objects. Set Defaults. Hook-up events.
  	2) Check for and validate cookie hash.
  		2.a - Get user info (username,bids,level,etc.)
  		2.b - Display user info bars and hide login/register (top & bottom)
  	3) Load auctions
  */

  /*
  	(1) Initialize
  */

  var cookie;
  $.ajaxSetup({
    async: true,
    dataType: "jsonp",
    jsonp: false,
    cache: false,
    type: "GET",
    beforeSend: function(xhr, settings) {},
    complete: function(xhr, status) {},
    error: function(xhr, status, error) {
      return showDialog("error", "Unexpected Error", error);
    }
  });
  $(".auction-bid-button").click(function() {
    var auction_id;
    auction_id = $(this).parent().attr("id");
    return jQuery.ajax({
      url: API + BID,
      data: {
        id: auction_id
      },
      success: function(data) {
        return alert(data);
      }
    });
  });
  /*
  	(2) User Auth
  */

  cookie = getCookie("pisoauction");
  if ((cookie != null) && cookie !== "") {
    $("#account-navigation").css("visibility", "visible");
    $("#account-navigation").css("display", "block");
    $("#bid-info").css("visibility", "visible");
    $("#bid-info").css("display", "block");
    $("#login-container").css("visibility", "hidden");
    $("#login-container").css("display", "none");
  } else {
    $.getScript("/js/register.js", function() {});
    $("#account-navigation").css("visibility", "hidden");
    $("#account-navigation").css("display", "none");
    $("#bid-info").css("visibility", "hidden");
    $("#bid-info").css("display", "none");
    $("#login-container").css("visibility", "visible");
    $("#login-container").css("display", "block");
  }
  /*
  	2.a - Get user info
  */

  /*
  	2.b - Display user info
  */

  /*
  	(3) Load auctions
  */

  /*
  	<div id='{{auction.id}}' class='auction'>
  		<div class='auction-title'><a href='{{auction.productUrl}}'>{{auction.name}}</a></div>
  		<div class='auction-image'><img src='{{auction.imageUrl}}' alt='{{auction.name}}' /></div>
  		<div class='auction-info'>
  			<div class='auction-current-price'>â‚±{{auction.price}}</div>
  			<div class='auction-time-remaining'>{{auction.auctionRemaining}}</div>
  			<div class='auction-current-winner'>{{auction.currentWinner}}</div>
  		</div>
  		<div class='auction-bid-button'>Bid!</div>
  		<div class='auction-footer'></div>
  	</div>
  */

  window.setInterval((function() {
    return $(".auction-time-remaining").each(function(i) {
      var d, oldHours, parts;
      parts = this.innerHTML.split(":");
      d = new Date();
      d.setHours(parts[0]);
      d.setMinutes(parts[1]);
      d.setSeconds(parts[2]);
      oldHours = d.getHours();
      d.setSeconds(d.getSeconds() - 1);
      if (oldHours >= d.getHours()) {
        this.innerHTML = padzero(d.getHours(), 2) + ":" + padzero(d.getMinutes(), 2) + ":" + padzero(d.getSeconds(), 2);
        if (this.innerHTML === "00:00:00") {
          this.style.backgroundColor = "#CC0000";
          return $(this).animate({
            backgroundColor: "#FFFFFF"
          }, "slow");
        }
      } else {
        return this.innerHTML = "00:00:00";
      }
    });
  }), 1000);
  return $(".auction-time-remaining").each(function(i) {
    var d, oldHours, parts;
    parts = this.innerHTML.split(":");
    d = new Date();
    d.setHours(parts[0]);
    d.setMinutes(parts[1]);
    d.setSeconds(parts[2]);
    oldHours = d.getHours();
    if (oldHours >= d.getHours()) {
      return this.innerHTML = padzero(d.getHours(), 2) + ":" + padzero(d.getMinutes(), 2) + ":" + padzero(d.getSeconds(), 2);
    }
  });
});
